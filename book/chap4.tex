
\chapter{个性化搜索背后的核心技术}
\thispagestyle{empty}

\setlength{\fboxrule}{0pt}\setlength{\fboxsep}{0cm}
\noindent\shadowbox{
\begin{tcolorbox}[arc=0mm,colback=lightblue,colframe=darkblue,title=学习目标与要求]
%\kai\textcolor{darkblue}{1.~~强化学习．} \\ 

\end{tcolorbox}}
\setlength{\fboxrule}{1pt}\setlength{\fboxsep}{4pt} 

个性化搜索最根本的目标是要根据用户的意图和喜好展示搜索结果页，抛弃目前这种千篇一律的展现方式。个性化体现了搜索系统的智能性，从提高用户体验方面加深了用户对淘宝的粘性。

\section{用户肖像建模} 
	物以类聚，人以群分。不同的人群，在总体上有着不同的行为特点和购物需求。我们对用户的了解，是从他/她所属的人群开始的。人群可以按不同的维度划分，如性别、年龄、购买力、地域等。例如，在服饰行业中，男性用户更喜欢买男装，女性用户更喜欢买女装。这样，在用户搜索“T恤”时，我们可以根据他的性别展示更符合他偏好的结果。不同年龄段的用户的购物需求也会有明显的差异，例如穿衣风格或者手机款式。
	为了识别用户所属的人群，需要使用尽量多的数据。最基础的是用户注册的信息，不过这种信息有时并不准确。比如，用户注册时填的不准确，或者用户把账号长期给家人使用。所以还需要使用用户在网站上的行为数据来校正这些数据。这时会使用机器学习的方法，把用户肖像建模看成一个分类问题，使用各种来源的数据来预测用户所属的人群。
	\subsection{性别}
	性别作为用户最重要的基本属性之一，必然是个性化考虑因素。对电子商务网站来讲，性别也是搜索和推荐系统决策因素之一。淘宝主要消费群体是女性，用户数据容易被女性行为主导，人气排序下表现尤为明显。性别个性化则是根据用户的性别影响排序，在用户query没有明确表明性别的情况下提前与用户性别相同的商品，旨在减少翻页次数or换query次数从而提高ctr。另外，如果用户能看到更多与其购买意图相关的商品，可能会提高成交转化率。
	\paragraph{背景}
	为了利用性别影响排序，首先需要解决如何标记商品性别。商品的性别可通过类目或者属性来表现，而类目的性别表现又分为窄义性别和广义性别。窄义性别表现类目有服饰、鞋和包等，此类型只要提前相应类目或者类目下具有某些特征的商品即可；广义性别表现类目包括窄义类目和诸如手机、电脑、游戏币等隐含类别，该类型下商品的性别与类目无关，而是由商品本身的特征决定的，如颜色、风格等（与性别无明显关系），这类性别标签需要挖掘才能发现。
	性别个性化另外一个重要的方面是如何预测用户性别。用户注册时的性别信息和支付宝实名认证都可以作为判断性别的依据，但考虑到用户可能填错以及实名认证用户少、甚至有账号被同时多个用户使用的情况，我们不能直接应用这些信息。个性化用到的性别必须有物理性别与淘宝性别之分，所以必须建立一套合理的性别预测方案。
	\paragraph{建模}
	训练:
	根据一级类目成交的性别占比得到男性、女性、无性别购买类目组（一级类目的子集）。对有购买记录的用户：根据用户在性别相关类目下的ipv及ipv天数、支付宝笔数及金额、虚拟物品笔数占比及不同时间段ipv占比计算各维度权重，得到回归模型。对无购买记录的用户：女性类目总体ipv和ipv天数、男性类目总体ipv及用户注册时长作为预测维度计算权重得到回归模型。
	预测:
	根据用户是否有成交启用不同模型，回归值大于等于0时为女性，否则为男性。
	\paragraph{特征}
	\begin{itemize}
	\item{分别15个女性、男性倾向类目的点击总数}
	\item{分别15个女性、男性倾向类目的购买总数}
	\item{强女性类目点击天数}
	\item{强男性类目点击天数}
	\item{总点击天数}
	\item{强女性类目购买天数}
	\item{强男性类目购买天数}
	\item{总购买天数}
	\item{女性倾向类目点击次数占比}
	\item{男性倾向类目点击次数占比}
	\item{点击占比熵}
	\item{女性倾向类目购买次数占比}
	\item{男性倾向类目购买次数占比}
	\item{购买占比熵}
	\item{强女性、男性类目类目点击天数差占有点击天数的比例}
	\item{强女性、男性类目类目购买天数差占有购买天数的比例}
	\end{itemize}
	\paragraph{效果}
	最终效果，总体召回率：86\%，总体准确率：94\%。
	\begin{table}
		\centering
		\caption{准确率}
		\begin{tabular}
			{|l|l|l|l|l|l|}
			\hline
			新版&样本数&预测男&预测女&召回率&准确率\\
			\hline
			真实男&1380636&1192135&73080&86.3\%&93.4\%\\
			\hline
			真实女&1353568&84840&1156177&85.4\%&94.1\%\\
			\hline
		\end{tabular}
		\label{性别准确率}
	\end{table}
	\subsection{年龄}
	用户年龄的识别可以简单的使用身份证上的生日计算年龄。
	\subsection{购买力}
	随着中国经济和电子商务的快速发展，用户也在快速成长，对于高品质、高端商品的需求不断上升，而目前我们的搜索对于这部分用户需求的满足不是很好，高端用户在不断流失。本项目的旨在通过算法和运营配合挖掘出淘宝上的高端用户，同时展现给这些用户合适的商品，以提高这部分用户的体验和留存率。
	\paragraph{商品的价格档}
	为了便于在业务中分析各种数据，可以将用户的购买力分成几个档次（如1~7档），档次越高表示用户的购买力越大。用户的购物行为中可以很方便的体现购买力。这时需要先确定商品的价格档。由于每个类目商品的价格差异很大，所以需要按类目来划分。
	例如：最近一个月主搜引导成交的笔单价从小到大排序，按指定分位点划分成七档，如：0,0.2,0.4,0.6,0.8,0.9,0.95,1。
	\paragraph{用户购买力模型}
	我们使用了GBDT模型，训练用户的购买力。以未来搜索引导的成交在类目下的价格分档为目标，建立了一个多分类的模型。
	\paragraph{特征}
	\begin{itemize}
		\item{服饰类成交额、笔单价（衣）}
		\item{食品类成交额、笔单价（食）}
		\item{日用品开销（家居百货）}
		\item{是否有房+住房档次（住）}
		\item{装修档次（住）}
		\item{是否有车+车档次（行）}
		\item{酒店门票类开销（行）}
		\item{购买品牌、奢侈品}
		\item{职业}
		\item{教育程度}
		\item{年龄段}
		\item{手机型号}
		\item{资产等级}
		\item{好友关系}
	\end{itemize}
	\subsection{家庭账号}
	但由于家庭账号，或者代买的情况。
	\subsection{用户-商品CTR预估}
	\paragraph{背景}
	“个性化”在淘宝搜索中起着至关重要的作用，即让不同的用户看到最符合自己需求的商品。为了实现这个目标，最直接的方式就是预估商品到不同人群的ctr。当用户搜索时，使用这个分数排序，就可以把符合用户所属人群的商品优先展示。
	\paragraph{建模}
	

\section{匹配学习}
	
	
\subsection{一阶人货匹配模型} 
	@席奈 u2i，u2s，u2b 

\subsection{高阶人货匹配模型} 
	@席奈 u2i2i，u2s2i，u2b2i 

\subsection{深度匹配模型} 

\subsection{序列匹配模型} 
	
\section{排序学习}
	@元涵，@凌运， @龙楚
	\subsection{个性化体验}
	在搜索中有一些体验问题，如年龄，可以转换成某种约束，如$f(user\_age,auc\_age)\geq0$。在ltr模型中加入这种约束，变成带约束的优化问题，可以同时实现搜索体验和指标的最大化。
	

\section{展示学习}
	个性化短标题：@苏哲，@仁重 

\section{模型参数优化} 
	@公达

\begin{thebibliography}{99}
\addcontentsline{toc}{chapter}{\protect\numberline{}{\hspace{-1.5em}参考文献}}
\markboth{参考文献}{参考文献}
\bibitem{1} 淘宝搜索全链路有效行为量化模型(UBM\&UCM), http://www.atatech.org/articles/38550
\bibitem{2} User Browsing Model的实现与应用, http://www.atatech.org/articles/23111
\bibitem{3} 搜索个性化介绍, http://www.atatech.org/articles/48548
\end{thebibliography}

 
